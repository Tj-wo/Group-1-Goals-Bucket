<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:p="http://primefaces.org/ui">

<h:head>
    <f:facet name="first">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
    </f:facet>
    <title>KPI Tracker - Login</title>

    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: white;
            min-height: 100vh;
            display: flex;
            align-items: stretch;
            justify-content: stretch;
        }

        .login-container {
            background: white;
            border-radius: 0;
            box-shadow: none;
            overflow: hidden;
            width: 100%;
            height: 100vh;
            display: flex;
            margin: 0;
        }

        .login-left {
            flex: 0 0 65%;
            background: linear-gradient(135deg, #f8f9ff 0%, #e8f2ff 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 60px 40px;
            position: relative;
            overflow: hidden;
        }

        .login-left::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('#{resource["images/loginImage.jpg"]}') no-repeat center center;
            background-size: cover;
            opacity: 0.1;
            z-index: 1;
        }

        .login-left-content {
            position: relative;
            z-index: 2;
            text-align: center;
            color: #2c3e50;
            max-width: 500px;
        }

        .login-left h1 {
            font-size: 3rem;
            margin-bottom: 30px;
            font-weight: 800;
            color: #2c3e50;
            line-height: 1.2;
        }

        .login-left p {
            font-size: 1.3rem;
            margin-bottom: 40px;
            color: #5a6c7d;
            line-height: 1.6;
            font-weight: 400;
        }

        .login-right {
            flex: 0 0 35%;
            padding: 80px 50px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            background: white;
            border-left: 1px solid #e1e8ed;
        }

        .login-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .login-header h2 {
            color: #2c3e50;
            font-size: 2.2rem;
            margin-bottom: 15px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .login-header p {
            color: #7f8c8d;
            font-size: 1.1rem;
            margin: 0;
            line-height: 1.5;
        }

        .form-group {
            margin-bottom: 30px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #2c3e50;
            font-weight: 600;
            font-size: 1rem;
            text-transform: none;
            letter-spacing: 0;
        }

        .form-group input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            box-sizing: border-box;
            background: #f8f9fa;
        }

        .form-group input:focus {
            outline: none;
            border-color: #6c5ce7;
            box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.1);
            background: white;
        }

        .form-options {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .remember-me {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .remember-me input[type="checkbox"] {
            width: auto;
            margin: 0;
        }

        .remember-me label {
            margin: 0;
            font-size: 0.9rem;
            color: #7f8c8d;
            text-transform: none;
            letter-spacing: normal;
        }

        .forgot-password {
            color: #3498db;
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.3s ease;
        }

        .forgot-password:hover {
            color: #2980b9;
            text-decoration: underline;
        }

        .login-button {
            width: 100%;
            padding: 18px;
            background: #6c5ce7;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: none;
            letter-spacing: 0;
        }

        .login-button:hover {
            background: #6EBE46;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(108, 92, 231, 0.3);
        }

        .login-button:active {
            transform: translateY(0);
        }

        .logo-container {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 10;
        }

        .logo-container img {
            height: 40px;
            width: auto;
        }

        @media (max-width: 768px) {
            .login-container {
                flex-direction: column;
                margin: 0;
                width: 100%;
                height: 100vh;
            }

            .login-left {
                flex: 0 0 40%;
                min-height: 40vh;
                padding: 40px 20px;
            }

            .login-left h1 {
                font-size: 2.2rem;
            }

            .login-left p {
                font-size: 1.1rem;
            }

            .login-right {
                flex: 0 0 60%;
                padding: 40px 30px;
                border-left: none;
                border-top: 1px solid #e1e8ed;
            }
        }

        .floating-shapes {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 1;
        }

        .shape {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }

        .shape:nth-child(1) {
            width: 80px;
            height: 80px;
            top: 20%;
            left: 10%;
            animation-delay: 0s;
        }

        .shape:nth-child(2) {
            width: 120px;
            height: 120px;
            top: 60%;
            right: 10%;
            animation-delay: 2s;
        }

        .shape:nth-child(3) {
            width: 60px;
            height: 60px;
            bottom: 20%;
            left: 20%;
            animation-delay: 4s;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0px) rotate(0deg);
            }

            50% {
                transform: translateY(-20px) rotate(180deg);
            }
        }

        /* Message Styling */
        .ui-messages {
            margin-bottom: 20px;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .ui-messages .ui-messages-info {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px 20px;
            border-radius: 8px;
            font-size: 0.95rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #28a745;
        }

        .ui-messages .ui-messages-error {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 15px 20px;
            border-radius: 8px;
            font-size: 0.95rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #dc3545;
        }

        .ui-messages .ui-messages-warn {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px 20px;
            border-radius: 8px;
            font-size: 0.95rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #ffc107;
        }

        .ui-messages .ui-messages-fatal {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 15px 20px;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #dc3545;
        }

        .ui-messages .ui-message-icon {
            margin-right: 10px;
            font-size: 1.1rem;
        }

        .ui-messages .ui-message-close {
            float: right;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.3rem;
            line-height: 1;
            color: inherit;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }

        .ui-messages .ui-message-close:hover {
            opacity: 1;
        }

        /* Hide messages after 5 seconds */
        .ui-messages {
            animation: slideDown 0.3s ease-out, fadeOut 0.3s ease-in 4.7s forwards;
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
                transform: translateY(-10px);
            }
        }

        /* Validation error styling */
        .validation-error {
            color: #dc3545;
            font-size: 0.875rem;
            margin-top: 5px;
            display: block;
        }

        .ui-message.validation-error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 8px 12px;
            border-radius: 4px;
            margin-top: 5px;
            font-size: 0.875rem;
        }
    </style>
</h:head>

<h:body>
    <div class="login-container">
        <div class="login-left">
            <div class="logo-container">
                <h:graphicImage name="images/cropped-Original-logo_1-2 (1).png" alt="Pahappa Logo" />
            </div>
            <div class="floating-shapes">
                <div class="shape"> </div>
                <div class="shape"></div>
                <div class="shape"></div>
            </div>
            <div class="login-left-content">
                <h1> Pahappa Goals Bucket</h1>
                <p>Align goals, track performance with the platform. Whether it's Company growth, Project
                    milestones, or Employee Perfomance.
                    Pahappa Goal Bucket gives you the tools to monitor your vision turn into reality one goal at a time.
                </p>
            </div>
        </div>

        <div class="login-right">
            <h:form id="loginForm" prependId="false">
                <!-- Message Display Area -->
                <div id="messageArea" style="margin-bottom: 20px;">
                    <p:messages id="messages" showDetail="true" showSummary="true" closable="true" autoUpdate="true"
                        styleClass="ui-messages" infoStyleClass="ui-messages-info" warnStyleClass="ui-messages-warn"
                        errorStyleClass="ui-messages-error" fatalStyleClass="ui-messages-fatal" />
                </div>

                <!-- Check authentication status on page load -->
                <h:outputScript>
                    // Check for authentication errors when page loads
                    if (window.location.search.includes('error=true')) {
                        // Show error message
                        var messagesDiv = document.getElementById('messages');
                        if (messagesDiv) {
                            messagesDiv.innerHTML = '<div class="ui-messages ui-messages-error" style="display: block;"><div class="ui-message ui-message-error"><span class="ui-message-icon pi pi-times"></span>Invalid email or password. Please check your credentials and try again.<span class="ui-message-close">×</span></div></div>';
                        }
                    } else if (window.location.search.includes('logout=true')) {
                        // Show logout message
                        var messagesDiv = document.getElementById('messages');
                        if (messagesDiv) {
                            messagesDiv.innerHTML = '<div class="ui-messages ui-messages-info" style="display: block;"><div class="ui-message ui-message-info"><span class="ui-message-icon pi pi-check"></span>You have been successfully logged out. Thank you for using KPI Tracker!<span class="ui-message-close">×</span></div></div>';
                        }
                    } else if (window.location.search.includes('expired=true')) {
                        // Show expired message
                        var messagesDiv = document.getElementById('messages');
                        if (messagesDiv) {
                            messagesDiv.innerHTML = '<div class="ui-messages ui-messages-warn" style="display: block;"><div class="ui-message ui-message-warn"><span class="ui-message-icon pi pi-exclamation-triangle"></span>Your session has expired. Please log in again to continue.<span class="ui-message-close">×</span></div></div>';
                        }
                    }
                </h:outputScript>

                <div class="login-header">
                    <h2 style="text-align: center">Sign In </h2>
                    <p>Please sign-in to your account and start the adventure</p>
                </div>

                <div class="form-group">
                    <label for="j_username">Email</label>
                    <p:inputText id="j_username" required="true" placeholder="admin@kpitracker.com"
                        requiredMessage="Email address is required"
                        style="width: 100%; padding: 15px 20px; border: 2px solid #e1e8ed; border-radius: 8px; font-size: 1rem; box-sizing: border-box; background: #f8f9fa;">
                        <p:ajax update="j_username" />
                    </p:inputText>
<!--                    <p:message for="j_username" styleClass="validation-error" />-->
                </div>

                <div class="form-group">
                    <label for="j_password">Password</label>
                    <p:password id="j_password" required="true" placeholder="Enter your password" type="password"
                        requiredMessage="Password is required"
                        style="width: 100%; padding: 15px 20px; border: 2px solid #e1e8ed; border-radius: 8px; font-size: 1rem; box-sizing: border-box; background: #f8f9fa;">
                        <p:ajax update="j_password" />
                    </p:password>
<!--                    <p:message for="j_password" styleClass="validation-error" />-->
                </div>

                <div class="form-options">
                    <div class="remember-me">
                        <p:selectBooleanCheckbox id="remember-me" />
                        <p:outputLabel for="remember-me" value="Remember Me" />
                    </div>
                    <a href="#" class="forgot-password">Forgot Password?</a>
                </div>

                <p:commandButton id="login" value="Sign in" ajax="false" styleClass="login-button" validateClient="true"
                    update="loginForm" action="#{loginController.doLogin}" />
            </h:form>
        </div>
    </div>

    <h:outputStylesheet name="css/primeicons.css" library="california-layout" />
    <h:outputStylesheet name="css/primeflex.min.css" library="california-layout" />
    <h:outputStylesheet name="css/layout-#{guestPreferences.theme}.css" library="california-layout" />
</h:body>

</html>